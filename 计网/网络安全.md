### 网络安全

#### 1. XXS攻击

跨站脚本攻击，指恶意攻击者利用网站没有对用户提交数据进行转义处理或者过滤不足的缺点，进而添加一些 代码，嵌入到web页面中去。使别的用户访问都会执行相应的嵌入代码。 从而盗取用户资料、利用用户身份进行某种动作或者对访问者进行病毒侵害的一种攻击方式。

**原因解析：**

浏览器过于信任客户端提交的数据，在数据中插入一些字符以及JS代码，那么这些数据就会成为应用代码中的一部分，从而展开攻击。

**类型：**

持久型：持久型也就是攻击的代码被写入数据库中，这个攻击危害性很大，如果网站访问量很大 的话，就会导致大量正常访问的页面，就会导致大量正常访问页面的用户都受到攻击。最典型的 就是留言板的XSS攻击。

非持久型：非持久型XSS是指发送请求时，XSS代码出现在请求的URL中，作为参数提交到服务		器，服务器解析并响应。响应结果中包含XSS代码，最后浏览器解析并执行，从概念上可以看出，	反射型XSS代码首先是出现在URL中，然后需要服务端解析，最后需要浏览器之后XSS代码才能攻击。

**危害：**

- 盗取各类用户帐号，如机器登录帐号、用户网银帐号、各类管理员帐号
- 控制企业数据，包括读取、篡改、添加、删除企业敏感数据的能力
- 盗窃企业重要的具有商业价值的资料
- 非法转账
- 强制发送电子邮件
- 网站挂马
- 控制受害者机器向其它网站发起攻击

**防御方法：**

- **转义字符**

转义输入输出内容，对于括号，尖括号，斜杠进行转义

- **CSP**

内容安全策略 (CSP) 是一个额外的安全层，用于检测并削弱某些特定类型的攻击，包括跨站脚本 (XSS) 和数据注入攻击等。无论是数据盗取、网站内容污染还是散发恶意软件，这些攻击都是主要的手段。

CSP通过指定有效域——即浏览器认可的可执行脚本的有效来源——使服务器管理者有能力减少或消除XSS攻击所依赖的载体。一个CSP兼容的浏览器将会仅执行从白名单域获取到的脚本文件，忽略所有的其他脚本 (包括内联脚本和HTML的事件处理属性)。

作为一种终极防护形式，始终不允许执行脚本的站点可以选择全面禁止脚本执行。

CSP本质上就是建立白名单，开发者明确告诉浏览器哪些外部资源可以进行加载和执行，我们只需要配置规则，如何拦截是由浏览器自己实现的，我们可以通过这种方式来尽量减少XSS攻击。

**开启CSP的方法：**

```js
//1.设置HTTP header中的Content-Security-Policy: policy
Content-Security-Policy: default-src 'self';//只允许加载本站资源
Content-Security-Policy: default-src 'self' *.trusted.com;//只允许来自信任的域名及子域名
Content-Security-Policy: default-src 'self';img-src *;media-src media1.com media2.com;script-src userscripts.example.com;//只允许来自设置的源的图片，限制音频或者视频需从信任的资源提供者处获得
Content-Security-Policy: img-src https://* //只允许加载https协议的图片

//2.设置meta标签的方式
meta http-equiv=“Content-Security-Policy” content=“default-src ‘self’;img-src https://*; child-src ‘none’;”>
```



#### 2.CSRF

跨站请求伪造，通过伪装成受信任用户的请求来利用受信任的网站。与XSS攻击相比，CSRF攻击往往不大流行（因此对其进行防范的资源也相当稀少）和难以防范，所以被认为比XSS更具危险性。

**原理解析：**

原理就是攻击者构造出一个后端请求地址，诱导用户点击或者通过某些途径自动发起请求。如果用户是在登录状态下的话，后端就以为是用户在操作，从而进行相应的逻辑。

也就是完成一次CSRF攻击，受害者必须依次完成两个步骤: 1 登录受信任的网站，并在本地生成Cookie 2 在不登出信任网站的情况下，访问危险网站。

**危害：**

攻击者盗用了你身份，以你的名义发送恶意请求,CSRF能够做的事情:以你的名义发送邮件，盗取你的账号甚至是购买商品，虚拟货币的转账，个人隐私泄露和财产安全。

**防御方法：**

- GET请求不对数据进行修改
- 不让第三方网站访问到Cookie
- 阻止第三方网站请求接口
- 请求时附带验证信息，比如验证码或者Token

SameSite

- 可以对Cookie设置SameSite属性，该属性表示Cookie不随着跨域请求发送，可以很大程度上减少CSRF的攻击，但是该属性目前并不是所有浏览器都兼容

验证 Referer HTTP头部

- 对于需要防范CSRF的请求，我们可以通过验证Referer来判断请求是否为第三方网站发起的.

Token服务端核对令牌

- 服务器下发一个服务端核对令牌随机Token，每次发送请求时将Token携带上，服务器验证Token是否有效

验证码

- 这个方案的思路是：每次的用户提交都需要用户在表单中填写一个图片上的随机字符串，厄…这个方案可以完全解决CSRF，但个人觉得在易用性方面似乎不是太好，还有听闻是验证码图片的使用涉及了一个被称为MHTML的Bug，可能在某些版本的微软IE中受影响。